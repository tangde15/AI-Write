# ğŸ’¬ ä¸‰ç«¯ç§ä¿¡åŠŸèƒ½ - å®ç°æ€è·¯ä¸è®¾è®¡

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

ä¸ºå­¦ç”Ÿã€æ•™å¸ˆã€å®¶é•¿ä¸‰ç§è§’è‰²æä¾›äº’ç›¸ç§ä¿¡åŠŸèƒ½ï¼Œç±»ä¼¼äºå³æ—¶é€šè®¯åº”ç”¨ã€‚

## ğŸ¯ æ ¸å¿ƒéœ€æ±‚

### 1. ç§ä¿¡åŠŸèƒ½èŒƒå›´
- **å­¦ç”Ÿ â†” æ•™å¸ˆ**ï¼šå­¦ç”Ÿå¯ä»¥å‘æ•™å¸ˆæé—®ï¼Œæ•™å¸ˆå¯ä»¥å›å¤æŒ‡å¯¼
- **å­¦ç”Ÿ â†” å®¶é•¿**ï¼šå­¦ç”Ÿå¯ä»¥å‘å®¶é•¿åˆ†äº«å­¦ä¹ æƒ…å†µï¼Œå®¶é•¿å¯ä»¥é¼“åŠ±
- **æ•™å¸ˆ â†” å®¶é•¿**ï¼šæ•™å¸ˆå¯ä»¥å‘å®¶é•¿åé¦ˆå­¦ç”Ÿå­¦ä¹ æƒ…å†µ

### 2. åŠŸèƒ½ç‰¹æ€§
- âœ… åŒå‘ç§ä¿¡ï¼ˆä»»ä½•äººå¯ä»¥å‘èµ·ï¼‰
- âœ… æ¶ˆæ¯åˆ—è¡¨æ˜¾ç¤ºæ‰€æœ‰å¯¹è¯
- âœ… æœªè¯»æ¶ˆæ¯æé†’
- âœ… æ¶ˆæ¯å·²è¯»/æœªè¯»çŠ¶æ€
- âœ… å‘é€æ–‡å­—æ¶ˆæ¯
- âœ… æ˜¾ç¤ºå‘é€æ—¶é—´

---

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### æ–°å¢è¡¨ï¼š`private_message`

```sql
CREATE TABLE IF NOT EXISTS private_message (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    sender_id BIGINT NOT NULL,          -- å‘é€è€…ID
    receiver_id BIGINT NOT NULL,         -- æ¥æ”¶è€…ID
    content TEXT NOT NULL,               -- æ¶ˆæ¯å†…å®¹
    is_read BOOLEAN DEFAULT FALSE,      -- æ˜¯å¦å·²è¯»
    created_at DATETIME,                 -- å‘é€æ—¶é—´
    updated_at DATETIME,
    INDEX idx_sender (sender_id),
    INDEX idx_receiver (receiver_id),
    INDEX idx_created (created_at),
    CONSTRAINT fk_msg_sender FOREIGN KEY (sender_id) REFERENCES user_account(id),
    CONSTRAINT fk_msg_receiver FOREIGN KEY (receiver_id) REFERENCES user_account(id)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci;
```

**è¡¨ç»“æ„è¯´æ˜ï¼š**
- `sender_id` + `receiver_id` ç»„æˆå¯¹è¯å…³ç³»
- æ”¯æŒåŒå‘æŸ¥è¯¢ï¼ˆæˆ‘å‘é€çš„ + æˆ‘æ¥æ”¶çš„ï¼‰
- `is_read` æ ‡è®°æœªè¯»æ¶ˆæ¯
- ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½

---

## ğŸ–¥ï¸ å‰ç«¯ç•Œé¢è®¾è®¡

### å¸ƒå±€å‚è€ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [æœç´¢æ¡†]            ç§ä¿¡                  [+æ–°å»ºå¯¹è¯]        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  â”‚                                          â”‚
â”‚  æ¶ˆæ¯åˆ—è¡¨        â”‚         èŠå¤©çª—å£                         â”‚
â”‚                  â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“© æ•™å¸ˆA  ğŸ‘¤â”‚  â”‚  â”‚  ğŸ‘¤ å¼ ä¸‰è€å¸ˆ                        â”‚  â”‚
â”‚  â”‚ ä»Šå¤©ä½œæ–‡æ€...â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ 19:30    2  â”‚  â”‚  â”‚                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚     [ä½ å¥½ï¼Œè¯·é—®ä»Šå¤©çš„ä½œæ–‡...]           â”‚  â”‚
â”‚                  â”‚  â”‚         19:30   âœ“                    â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚                                    â”‚  â”‚
â”‚  â”‚ ğŸ“© å®¶é•¿B  ğŸ‘¤â”‚  â”‚  â”‚  [æˆ‘çš„ä½œæ–‡å†™å®Œäº†ï¼Œè¯·...] 19:35    â”‚  â”‚
â”‚  â”‚ å­©å­æœ€è¿‘...â”‚  â”‚  â”‚     âœ“                            â”‚  â”‚
â”‚  â”‚ æ˜¨å¤©  âœ“     â”‚  â”‚  â”‚                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚                                    â”‚  â”‚
â”‚                  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ [è¾“å…¥æ¶ˆæ¯...]          [å‘é€]        â”‚  â”‚
â”‚  â”‚ å­¦ç”ŸC  ğŸ‘¨â€ğŸ“ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”‚ æˆ‘æƒ³çœ‹...  â”‚  â”‚                                          â”‚
â”‚  â”‚ å‘¨ä¸€   âœ“   â”‚  â”‚                                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1. å·¦ä¾§æ¶ˆæ¯åˆ—è¡¨

**æ˜¾ç¤ºå†…å®¹ï¼š**
- å¯¹æ–¹çš„å¤´åƒï¼ˆæ ¹æ®è§’è‰²æ˜¾ç¤ºä¸åŒå›¾æ ‡ï¼‰
- å¯¹æ–¹å§“å
- æœ€åä¸€æ¡æ¶ˆæ¯é¢„è§ˆï¼ˆæœ€å¤š30ä¸ªå­—ç¬¦ + ...ï¼‰
- æ¶ˆæ¯æ—¶é—´ï¼ˆä»Šå¤©æ˜¾ç¤ºæ—¶é—´ï¼Œæ˜¨å¤©æ˜¾ç¤º"æ˜¨å¤©"ï¼Œæ›´æ—©æ˜¾ç¤ºæ—¥æœŸï¼‰
- æœªè¯»æ¶ˆæ¯æ•°é‡çº¢è‰²è§’æ ‡

**æ’åºè§„åˆ™ï¼š**
- æœ€è¿‘å¯¹è¯ç½®é¡¶
- æŒ‰æœ€åæ¶ˆæ¯æ—¶é—´é™åº

**æ ·å¼ï¼š**
```css
æ¶ˆæ¯åˆ—è¡¨é¡¹ï¼š
- æ‚¬åœï¼šæµ…ç°è‰²èƒŒæ™¯
- é€‰ä¸­ï¼šè“è‰²èƒŒæ™¯ + å·¦è¾¹è“è‰²ç«–çº¿
- æœªè¯»ï¼šç²—ä½“æ˜¾ç¤º
```

### 2. å³ä¾§èŠå¤©çª—å£

**æ˜¾ç¤ºå†…å®¹ï¼š**
- èŠå¤©å¯¹è±¡ä¿¡æ¯ï¼ˆå§“åã€è§’è‰²ï¼‰
- æ¶ˆæ¯æ°”æ³¡ï¼ˆåŒºåˆ†è‡ªå·±/å¯¹æ–¹ï¼‰
- å‘é€æ—¶é—´ï¼ˆåªæ˜¾ç¤ºï¼Œä¸é‡å¤ï¼‰
- æ¶ˆæ¯çŠ¶æ€ï¼ˆâœ“ å‘é€ä¸­ï¼Œâœ“âœ“ å·²é€è¾¾ï¼Œâœ“âœ“âœ“ å·²è¯»ï¼‰

**è¾“å…¥æ¡†ï¼š**
- å¤šè¡Œæ–‡æœ¬è¾“å…¥
- å›è½¦å‘é€ï¼ŒShift+Enteræ¢è¡Œ
- å‘é€æŒ‰é’®

**æ ·å¼ï¼š**
```css
è‡ªå·±çš„æ¶ˆæ¯ï¼šè“è‰²æ°”æ³¡ï¼Œå³å¯¹é½
å¯¹æ–¹çš„æ¶ˆæ¯ï¼šç°è‰²æ°”æ³¡ï¼Œå·¦å¯¹é½
å‘é€æ—¶é—´ï¼šç°è‰²å°å­—ï¼Œæ˜¾ç¤ºåœ¨æ¶ˆæ¯ä¸‹æ–¹
```

---

## ğŸ”§ åç«¯å®ç°æ–¹æ¡ˆ

### 1. å®ä½“ç±»ï¼š`PrivateMessage.java`

```java
@Entity
@Data
public class PrivateMessage {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @ManyToOne
    private UserAccount sender;      // å‘é€è€…
    
    @ManyToOne
    private UserAccount receiver;    // æ¥æ”¶è€…
    
    @Column(columnDefinition = "TEXT")
    private String content;          // æ¶ˆæ¯å†…å®¹
    
    private Boolean isRead;          // æ˜¯å¦å·²è¯»
    
    private LocalDateTime createdAt;
    private LocalDateTime updatedAt;
    
    @PrePersist
    void prePersist() {
        createdAt = LocalDateTime.now();
        updatedAt = LocalDateTime.now();
    }
}
```

### 2. Repositoryï¼š`PrivateMessageRepository.java`

```java
public interface PrivateMessageRepository extends JpaRepository<PrivateMessage, Long> {
    // è·å–æˆ‘ä¸æŸäººçš„å¯¹è¯ï¼ˆåŒå‘ï¼‰
    @Query("SELECT m FROM PrivateMessage m WHERE " +
           "(m.sender.id = :userId1 AND m.receiver.id = :userId2) OR " +
           "(m.sender.id = :userId2 AND m.receiver.id = :userId1) " +
           "ORDER BY m.createdAt ASC")
    List<PrivateMessage> getConversation(@Param("userId1") Long userId1, 
                                        @Param("userId2") Long userId2);
    
    // è·å–æ‰€æœ‰ä¸æˆ‘ç›¸å…³çš„æ¶ˆæ¯åˆ—è¡¨ï¼ˆç”¨äºå·¦ä¾§åˆ—è¡¨ï¼‰
    @Query("SELECT DISTINCT CASE " +
           "WHEN m.sender.id = :userId THEN m.receiver " +
           "ELSE m.sender END as partner " +
           "FROM PrivateMessage m " +
           "WHERE m.sender.id = :userId OR m.receiver.id = :userId")
    List<UserAccount> getChatPartners(@Param("userId") Long userId);
    
    // ç»Ÿè®¡æœªè¯»æ¶ˆæ¯æ•°
    @Query("SELECT COUNT(m) FROM PrivateMessage m " +
           "WHERE m.receiver.id = :userId AND m.isRead = false")
    long countUnreadMessages(@Param("userId") Long userId);
}
```

### 3. Serviceï¼š`MessageService.java`

**ä¸»è¦æ–¹æ³•ï¼š**
```java
// å‘é€æ¶ˆæ¯
PrivateMessage sendMessage(Long senderId, Long receiverId, String content)

// è·å–å¯¹è¯è®°å½•
List<PrivateMessage> getConversation(Long userId1, Long userId2)

// è·å–èŠå¤©åˆ—è¡¨
List<ChatConversation> getChatList(Long userId)

// æ ‡è®°æ¶ˆæ¯ä¸ºå·²è¯»
void markAsRead(Long messageId, Long userId)

// è·å–æœªè¯»æ¶ˆæ¯æ•°
long getUnreadCount(Long userId)
```

### 4. Controllerï¼š`MessageController.java`

**APIç«¯ç‚¹ï¼š**
```java
// è·å–èŠå¤©åˆ—è¡¨
GET /api/message/list

// è·å–ä¸æŸäººçš„å¯¹è¯
GET /api/message/conversation/:userId

// å‘é€æ¶ˆæ¯
POST /api/message/send

// æ ‡è®°æ¶ˆæ¯å·²è¯»
PUT /api/message/read/:messageId

// è·å–æœªè¯»æ¶ˆæ¯æ•°
GET /api/message/unread-count
```

---

## ğŸ¨ å‰ç«¯å®ç°æ–¹æ¡ˆ

### 1. åˆ›å»ºæ¶ˆæ¯ç»„ä»¶

**æ–‡ä»¶ç»“æ„ï¼š**
```
frontend/src/
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ Common/
â”‚   â”‚   â”œâ”€â”€ MessageList.vue       # å·¦ä¾§æ¶ˆæ¯åˆ—è¡¨
â”‚   â”‚   â””â”€â”€ ChatWindow.vue        # å³ä¾§èŠå¤©çª—å£
â””â”€â”€ api/
    â””â”€â”€ message.js                 # æ¶ˆæ¯API
```

### 2. æ¶ˆæ¯åˆ—è¡¨ç»„ä»¶

**åŠŸèƒ½ï¼š**
- åŠ è½½æ‰€æœ‰å¯¹è¯å¯¹è±¡
- æ˜¾ç¤ºæœ€åä¸€æ¡æ¶ˆæ¯
- æ˜¾ç¤ºæœªè¯»æ•°é‡
- é€‰ä¸­å¯¹è¯åˆ‡æ¢åˆ°èŠå¤©çª—å£

### 3. èŠå¤©çª—å£ç»„ä»¶

**åŠŸèƒ½ï¼š**
- åŠ è½½å†å²æ¶ˆæ¯
- æ˜¾ç¤ºèŠå¤©å¯¹è±¡ä¿¡æ¯
- è¾“å…¥æ¡†å‘é€æ¶ˆæ¯
- å®æ—¶æ›´æ–°ï¼ˆè½®è¯¢æˆ–WebSocketï¼‰

### 4. APIé›†æˆ

```javascript
// api/message.js
export const messageAPI = {
  // è·å–æ¶ˆæ¯åˆ—è¡¨
  getMessageList() {
    return api.get('/message/list')
  },
  
  // è·å–å¯¹è¯
  getConversation(userId) {
    return api.get(`/message/conversation/${userId}`)
  },
  
  // å‘é€æ¶ˆæ¯
  sendMessage(receiverId, content) {
    return api.post('/message/send', { receiverId, content })
  },
  
  // æ ‡è®°å·²è¯»
  markAsRead(messageId) {
    return api.put(`/message/read/${messageId}`)
  },
  
  // è·å–æœªè¯»æ•°é‡
  getUnreadCount() {
    return api.get('/message/unread-count')
  }
}
```

---

## ğŸ“± ç†æƒ³å®ç°æ•ˆæœ

### åœºæ™¯1ï¼šå­¦ç”ŸæŸ¥çœ‹ç§ä¿¡

```
å·¦ä¾§åˆ—è¡¨ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’¬ ç§ä¿¡ (5)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â— å¼ è€å¸ˆ ğŸ‘¨â€ğŸ«          â”‚
â”‚   ä»Šå¤©ä½œæ–‡æ€ä¹ˆå†™...     â”‚
â”‚   19:30      2æœªè¯»     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â— å¦ˆå¦ˆ ğŸ‘¨â€ğŸ‘©â€ğŸ‘§           â”‚
â”‚   å­©å­æœ€è¿‘å­¦ä¹ æ€ä¹ˆæ ·...  â”‚
â”‚   æ˜¨å¤©  âœ“             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   æè€å¸ˆ ğŸ‘¨â€ğŸ«          â”‚
â”‚   ä½ çš„ä½œæ–‡å†™å¾—å¾ˆå¥½      â”‚
â”‚   å‘¨ä¸€   âœ“            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å³ä¾§èŠå¤©ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘¨â€ğŸ« å¼ è€å¸ˆ                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ä½ å¥½ï¼Œè¯·é—®ä»Šå¤©çš„ä½œæ–‡æ€ä¹ˆ...] â”‚ 19:30 âœ“âœ“
â”‚                                    â”‚
â”‚         [æˆ‘çš„ä½œæ–‡å†™å®Œäº†ï¼Œè¯·...] 19:35 âœ“
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
[è¾“å…¥æ¶ˆæ¯...] [å‘é€]
```

### åœºæ™¯2ï¼šæ•™å¸ˆå‘å®¶é•¿åé¦ˆ

```
å·¦ä¾§åˆ—è¡¨ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â— å°æ˜çš„å®¶é•¿ ğŸ‘¨â€ğŸ‘©â€ğŸ‘§    â”‚
â”‚   å°æ˜æœ€è¿‘å†™ä½œè¿›æ­¥å¾ˆå¤§  â”‚
â”‚   20:00      1æœªè¯»     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å°çº¢ â¤ï¸               â”‚
â”‚   è€å¸ˆï¼Œæˆ‘æƒ³è¯·å‡...     â”‚
â”‚   æ˜¨å¤©  âœ“             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å³ä¾§èŠå¤©ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ å°æ˜çš„å®¶é•¿              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å°æ˜æœ€è¿‘å†™ä½œè¿›æ­¥å¾ˆå¤§ï¼Œç‰¹åˆ«æ˜¯  â”‚
â”‚ äº”æ„Ÿæå†™è¿ç”¨å¾—ç‰¹åˆ«å¥½ï¼        â”‚
â”‚ å»ºè®®ç»§ç»­é¼“åŠ±å­©å­ä¿æŒï¼        â”‚
â”‚                                    â”‚ 20:00 âœ“
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
[è¾“å…¥æ¶ˆæ¯...] [å‘é€]
```

---

## ğŸ”„ æ•°æ®æµè½¬

### å‘é€æ¶ˆæ¯æµç¨‹
```
1. å‰ç«¯ï¼šç”¨æˆ·è¾“å…¥æ¶ˆæ¯ + ç‚¹å‡»å‘é€
   â†“
2. APIè°ƒç”¨ï¼šPOST /api/message/send
   { receiverId: 123, content: "ä½ å¥½" }
   â†“
3. åç«¯ï¼šä¿å­˜æ¶ˆæ¯åˆ°æ•°æ®åº“
   - åˆ›å»ºPrivateMessageè®°å½•
   - isRead = false
   â†“
4. è¿”å›ï¼š{ id: 456, content: "ä½ å¥½", createdAt: "..." }
   â†“
5. å‰ç«¯ï¼šç«‹å³æ˜¾ç¤ºåœ¨èŠå¤©çª—å£
```

### åŠ è½½å¯¹è¯æµç¨‹
```
1. å‰ç«¯ï¼šç”¨æˆ·ç‚¹å‡»æŸä¸ªå¯¹è¯
   â†“
2. APIè°ƒç”¨ï¼šGET /api/message/conversation/:userId
   â†“
3. åç«¯ï¼šæŸ¥è¯¢åŒå‘æ¶ˆæ¯
   SELECT * FROM private_message
   WHERE (sender_id = 1 AND receiver_id = 2)
      OR (sender_id = 2 AND receiver_id = 1)
   ORDER BY created_at ASC
   â†“
4. è¿”å›ï¼šæ¶ˆæ¯åˆ—è¡¨
   â†“
5. å‰ç«¯ï¼šæ˜¾ç¤ºåœ¨èŠå¤©çª—å£
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

1. **æ¶ˆæ¯åˆ†é¡µåŠ è½½**
   - æ¯æ¬¡åŠ è½½20æ¡æ¶ˆæ¯
   - å‘ä¸Šæ»šåŠ¨åŠ è½½æ›´å¤šå†å²æ¶ˆæ¯

2. **æœªè¯»æ¶ˆæ¯æé†’**
   - åœ¨å¯¼èˆªæ æ˜¾ç¤ºæœªè¯»æ•°
   - å·¦ä¾§åˆ—è¡¨æ˜¾ç¤ºæœªè¯»å¯¹è¯

3. **å®æ—¶æ›´æ–°ï¼ˆå¯é€‰ï¼‰**
   - æ–¹å¼1ï¼šè½®è¯¢ï¼ˆæ¯3ç§’è¯·æ±‚ä¸€æ¬¡ï¼‰
   - æ–¹å¼2ï¼šWebSocketï¼ˆå®æ—¶æ¨é€ï¼‰

---

## ğŸ“Š å®ç°ä¼˜å…ˆçº§

### Phase 1ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰â­
- âœ… æ•°æ®åº“è¡¨è®¾è®¡
- âœ… åç«¯APIå®ç°
- âœ… æ¶ˆæ¯åˆ—è¡¨UI
- âœ… èŠå¤©çª—å£UI
- âœ… å‘é€/æ¥æ”¶æ¶ˆæ¯

### Phase 2ï¼ˆå¢å¼ºåŠŸèƒ½ï¼‰
- ğŸ”„ æœªè¯»æ¶ˆæ¯æé†’
- ğŸ”„ æ¶ˆæ¯çŠ¶æ€æ˜¾ç¤º
- ğŸ”„ æ¶ˆæ¯æ—¶é—´æ ¼å¼åŒ–

### Phase 3ï¼ˆä¼˜åŒ–åŠŸèƒ½ï¼‰
- â³ å®æ—¶æ¨é€ï¼ˆWebSocketï¼‰
- â³ æ¶ˆæ¯æœç´¢
- â³ æ–‡ä»¶å‘é€ï¼ˆå›¾ç‰‡ã€æ–‡æ¡£ï¼‰

---

## ğŸ¯ æ€»ç»“

**ç‰¹ç‚¹ï¼š**
- âœ¨ ç®€å•å®ç”¨ï¼Œä¸å¤æ‚
- âœ¨ æ”¯æŒä¸‰ç«¯äº’ç›¸ç§ä¿¡
- âœ¨ ç±»ä¼¼å³æ—¶é€šè®¯ä½“éªŒ
- âœ¨ å¯¹è¯å¼äº¤äº’å‹å¥½

**æ ¸å¿ƒæŠ€æœ¯ï¼š**
- åç«¯ï¼šSpring Boot + JPA
- å‰ç«¯ï¼šVue3 + Element Plus
- æ•°æ®åº“ï¼šMySQL

**é¢„è®¡å·¥ä½œé‡ï¼š**
- åç«¯ï¼š5-6ä¸ªæ–‡ä»¶ï¼ˆå®ä½“ã€Repositoryã€Serviceã€Controllerï¼‰
- å‰ç«¯ï¼š3-4ä¸ªç»„ä»¶ï¼ˆæ¶ˆæ¯åˆ—è¡¨ã€èŠå¤©çª—å£ã€è¾“å…¥æ¡†ï¼‰
- æ•°æ®åº“ï¼š1å¼ æ–°è¡¨ + ç´¢å¼•
- æ€»è€—æ—¶ï¼šçº¦2-3å°æ—¶

---

## ğŸ’¡ éœ€è¦ç¡®è®¤çš„é—®é¢˜

1. æ˜¯å¦éœ€è¦åœ¨æ¯ä¸ªé¡µé¢æ·»åŠ "ç§ä¿¡"å…¥å£ï¼Ÿ
   - å»ºè®®ï¼šåœ¨é¡¶éƒ¨å¯¼èˆªæ æ·»åŠ "ğŸ’¬ ç§ä¿¡"å›¾æ ‡
   
2. æ˜¯å¦éœ€è¦å®æ—¶æ¨é€ï¼Ÿ
   - ä¼˜å…ˆå®ç°è½®è¯¢ï¼Œåç»­å¯å‡çº§WebSocket
   
3. æ˜¯å¦éœ€è¦æ¶ˆæ¯æ’¤å›åŠŸèƒ½ï¼Ÿ
   - åˆæœŸä¸å®ç°ï¼Œä¿ç•™æ‰©å±•

**å¦‚æœç¡®è®¤ï¼Œæˆ‘å°±å¼€å§‹å®ç°ï¼** âœ¨

